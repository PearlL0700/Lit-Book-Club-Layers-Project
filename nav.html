<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation</title>

    <style>
        body {
            text-align: center;
            background-color: #646464;
            position: relative;
        }

        /* Canvas scaled 1.1x */
        canvas {
            background: url("./images/cabin.png") no-repeat center center;
            background-size: 100% 100%;
            border: 2px solid black;
            display: block;
            margin: 0 auto;
            transform: scale(1.1);
            transform-origin: top center;
        }

        /* Button Styling */
        img {
            cursor: pointer;
            border: none;
            background: none;
            /*width: 100px;
            height: 50px;*/
            position: absolute;
        }

        /* Button Positions (same as before â€” based on original canvas size) */

        #MOTIF1 {
            top: 380px;
            left: 1050px;
            width: 110px;
            height: 110px;
        }
        #MOTIF2 {
            top: 335px;
            left: 755px;
            width: 62px;
            height: 80px;
        }
        #MOTIF3 {
            top: 340px;
            left: 360px;
            width: 90px;
            height: 60px;
        }
        #MOTIF4 {
            top: 480px;
            left: 530px;
            width: 70px;
            height: 30px;
        }
        #MOTIF5 {
            top: 210px;
            left: 580px;
            width: 90px;
            height: 50px;
        }
        #S {
            top: 180px;
            left: 260px;
        }
    </style>
</head>

<body>

<h1>Museum: Effects of Fear</h1>

<canvas id="gameCanvas"></canvas>

<!-- Buttons -->
<img id="MOTIF1" src="./images/tree.png" alt="Tree Button">
<img id="MOTIF2" src="./images/rule.png" alt="Rule Button">
<img id="MOTIF3" src="./images/mask.png" alt="Mask Button">
<img id="MOTIF4" src="./images/bread.png" alt="Bread Button">
<img id="MOTIF5" src="./images/bag.png" alt="Bag Button">
<!--img id="S" src="./images/Synthesis.png" alt="Synthesis Button">-->

<script>
    // Canvas + character setup
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const bg = new Image();
    bg.src = "./images/cabin.png";

    const sprite = new Image();
    sprite.src = "./images/stickman.png";

    const sm = {
        x: 355,
        y: 535,
        width: 60,
        height: 60
    };

    let Xspeed = 0, Yspeed = 0;
    let moveUp = false, moveDown = false, moveLeft = false, moveRight = false;

    let characterRect = {top: 0, bottom: 0, left: 0, right: 0};

    // Resize canvas to EXACT background image size
    bg.onload = function() {
        canvas.width = bg.width;
        canvas.height = bg.height;
        update();
    };

    // Key controls
    window.addEventListener("keydown", e => {
        if (e.key === "ArrowUp") moveUp = true;
        if (e.key === "ArrowDown") moveDown = true;
        if (e.key === "ArrowLeft") moveLeft = true;
        if (e.key === "ArrowRight") moveRight = true;
    });

    window.addEventListener("keyup", e => {
        if (e.key === "ArrowUp") moveUp = false;
        if (e.key === "ArrowDown") moveDown = false;
        if (e.key === "ArrowLeft") moveLeft = false;
        if (e.key === "ArrowRight") moveRight = false;
    });

    window.addEventListener("keydown", e => {
    if (e.code === "Space") {
        alert("Stickman Position:\nX = " + sm.x + "\nY = " + sm.y);
    }
    });

    function update() {
        requestAnimationFrame(update);

        Xspeed = (moveLeft ? -5 : 0) + (moveRight ? 5 : 0);
        Yspeed = (moveUp ? -5 : 0) + (moveDown ? 5 : 0);

        sm.x += Xspeed;
        sm.y += Yspeed;

        // Keep inside canvas
        sm.x = Math.max(0, Math.min(sm.x, canvas.width - sm.width));
        sm.y = Math.max(0, Math.min(sm.y, canvas.height - sm.height));

        characterRect = {
            top: sm.y,
            bottom: sm.y + sm.height,
            left: sm.x,
            right: sm.x + sm.width
        };

        render();
    }

    function render() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(sprite, sm.x, sm.y, sm.width, sm.height);
    }

    // Button collision check helper
    function checkCollision(rect, x1, x2, y1, y2) {
        return (
            rect.right >= x1 &&
            rect.left <= x2 &&
            rect.bottom >= y1 &&
            rect.top <= y2
        );
    }

    // Button events
    document.getElementById("MOTIF1").onclick = () => {
        if (checkCollision(characterRect, 700, 835, 250, 384))
            location.href = "./LOTF.html";
        else alert("Stickman is not touching a button!");
    };

    document.getElementById("MOTIF2").onclick = () => {
        if (checkCollision(characterRect, 425, 540, 205, 310))
            location.href = "./Ender's%20Game.html";
        else alert("Stickman is not touching a button!");
    };

    document.getElementById("MOTIF3").onclick = () => {
        if (checkCollision(characterRect, 70, 190, 195, 305))
            location.href = "./naruto.html";
        else alert("Stickman is not touching a button!");
    };

    document.getElementById("MOTIF4").onclick = () => {
        if (checkCollision(characterRect, 225, 320, 324, 400))
            location.href = "./Salem%20Witch%20Trials.html";
        else alert("Stickman is not touching a button!");
    };

    document.getElementById("MOTIF5").onclick = () => {
        if (checkCollision(characterRect, 275, 400, 90, 175))
            location.href = "./intro.html";
        else alert("Stickman is not touching a button!");
    };

    document.getElementById("S").onclick = () => {
        if (checkCollision(characterRect, 430, 520, 330, 385))
            location.href = "./Synthesis.html";
        else alert("Stickman is not touching a button!");
    };
</script>

</body>
</html>
